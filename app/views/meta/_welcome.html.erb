<% if Setting.welcome_text.present? && (!meta_description? || !meta_keywords?) %>
  <% welcome_text = strip_textile(Setting.welcome_text) %>
  <% meta_description(truncate_description(welcome_text)) unless meta_description? %>
  <% meta_keywords(extract_keywords(welcome_text)) unless meta_keywords? %>
<% end %>

<% settings = Setting.plugin_meta %>

<% if settings[:open_graph] %>
  <% content_for(:header_tags) do %>
    <meta property="og:type" content="website" />
    <meta property="og:title" content="<%= h Setting.app_title %>" />
    <% if meta_description? %>
      <meta property="og:description" content="<%= h meta_description %>" />
    <% end %>
    <meta property="og:url" content="<%= h Setting.protocol %>://<%= h Setting.host_name %>" />
    <% unless settings[:open_graph_site].empty? %>
      <meta property="og:site_name" content="<%= h settings[:open_graph_site] %>" />
    <% end %>
  <% end %>
<% end %>

<% if settings[:twitter_cards] %>
  <% content_for(:header_tags) do %>
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="<%= h Setting.app_title %>" />
    <% if meta_description? %>
      <meta name="twitter:description" content="<%= h truncate_description(meta_description, 200) %>" />
    <% end %>
    <meta name="twitter:url" content="<%= h Setting.protocol %>://<%= h Setting.host_name %>" />
    <% unless settings[:twitter_site].empty? %>
      <meta name="twitter:site" content="<%= h twitter_username(settings[:twitter_site]) %>" />
    <% end %>
  <% end %>
<% end %>
